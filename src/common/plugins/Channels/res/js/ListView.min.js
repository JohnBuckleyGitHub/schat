var ChannelsList={retranslate:function(){$("#join-name").attr("placeholder",Utils.tr("channels_channel_name"))},online:function(){var a=SimpleChat.channel(SimpleChat.serverId());if(a!==null){ChannelsList.setName(a.Name)}ChannelsList.get()},get:function(){SimpleChat.feed(SimpleChat.serverId(),FEED_NAME_LIST,1);Loader.spinner.add("loading/channels")},setName:function(a){$("#server-name").text(a)}};ChannelsList.feed={read:function(a){if(a.type=="body"){if(a.feed==FEED_NAME_LIST){ChannelsList.feed.list(a.data,a.status)}}},list:function(d,b){$(".channel-item").remove();if(b==200||b==303){var a=d.channels;var e=$("#channels-list");for(var c=0;c<a.length;c++){var f=a[c];if(f.length<4){continue}e.append(ChannelsList.feed.listItem(f))}}Loader.spinner.remove("loading/channels")},listItem:function(b){var c=b[3];if(c==""){c='<span data-tr="channels_no_title">'+Utils.tr("channels_no_title")+"</span>"}var a=b[4];return'<div class="channel-item"><div class="channel-item-header"><i class="icon-'+(a&4?"secure":"channel")+'"></i>&nbsp;<a href="'+ChannelsView.toUrl(b[0],b[1])+'" class="nick color-'+(a&4?"green":"default")+'" id="'+b[0]+'">'+b[1]+'</a><span class="badge">'+b[2]+(a&2?'</span>&nbsp;<i class="icon-pin"></i>':"")+'</div><div class="channel-item-title">'+c+"</div></div>"}};Modal.create.create=function(b){var a=$("#modal-header h3");a.text(Utils.tr("channels_create_title"));a.attr("data-tr","channels_create_title");$.ajax({url:"create.html",isLocal:true,dataType:"html",success:function(c){$("#modal-body").html(c);$("#channel-create [data-tr]").each(function(){Utils.TR($(this).attr("data-tr"))});Utils.adjustWidth($("#channel-create .create-label"));$("#create-name").focus()}})};$(document).ready(function(){Utils.retranslate();ChannelsList.retranslate();ChannelsList.online();Modal.init();$("#join").on("click.join",function(c){c.preventDefault();var b=$("#join-name");var a=b.val();if(a.length>=3){ChannelsView.join(a);b.val("")}});$("body").on("click.channel",".nick",function(a){a.preventDefault();ChannelsView.join($(this).attr("id"))})});if(typeof SimpleChat!=="undefined"){SimpleChat.retranslated.connect(ChannelsList.retranslate);SimpleChat.online.connect(ChannelsList.online)}if(typeof ChannelsView==="undefined"){ChannelsView={join:function(a){},toUrl:function(b,a){return"#"}}}else{ChannelsView.feed.connect(ChannelsList.feed.read);ChannelsView.serverRenamed.connect(ChannelsList.setName)};