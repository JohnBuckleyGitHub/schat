Console.home={load:function(){$.ajax({url:"home.html",isLocal:true,dataType:"html",success:Console.home.loaded})},loaded:function(c){$("#page").html(c);Console.current="home";Utils.retranslate();var b=SimpleChat.channel(SimpleChat.serverId());if(b!==null){Console.setName(b.Name)}$("#nav-logout").on("click.home",function(d){d.preventDefault();Loader.spinner.add("loading/logout");SimpleChat.request(SimpleChat.serverId(),"delete","console/me")});var a=$("body");a.on("click.name","#name-ok",function(d){d.preventDefault();ConsoleView.setName(SimpleChat.serverId(),$("#name-edit").val());$("#modal").modal("hide")});Utils.adjustWidth($("#about-server-block .field-row-label"));Utils.adjustWidth($("#users-online-block .field-row-label"));Console.home.online()},online:function(){Console.home.getFeed(FEED_NAME_SERVER);Console.home.getFeed(FEED_NAME_USERS);var b=SimpleChat.encryption();var a=$("#server-encryption");if(b!==null){a.removeAttr("data-tr");a.removeClass("red-text");var c="";if(b.protocol==2){c="TLS v1"}else{if(b.protocol==0){c="SSL v3"}}a.html('<span class="green-text">'+c+"</span>");var d=b.daysToExpiry;if(d>0&&d<=42){a.append(' <span class="orange-text">'+ConsoleView.expirationText(d)+"</span>")}if(d<=0){a.append(' <span class="red-text" data-tr="console_cert_expired">'+Utils.tr("console_cert_expired")+"</span>")}}else{a.addClass("red-text");a.attr("data-tr","no-encryption");a.text(Utils.tr("no-encryption"))}},getFeed:function(a){Console.feed[a].body(SimpleChat.feed(SimpleChat.serverId(),a,3),SimpleChat.serverId(),300);SimpleChat.feed(SimpleChat.serverId(),a,1)},prepare:function(b,a){if(a==300){Loader.spinner.add("loading/"+b);return true}Loader.spinner.remove("loading/"+b);return a==200}};Console.feed.console.del.me=function(a){if(a.status==200){Loader.spinner.add("loading/try");SimpleChat.get(SimpleChat.serverId(),"console/try")}Loader.spinner.remove("loading/logout")};Console.feed.server.body=function(c,d,b){if(!Console.home.prepare(FEED_NAME_SERVER,b)||c===false){return}var a=$("#server-version");a.text(c.version);a.append(' <i class="icon-os os-'+Pages.os(c.os)+'"></i>')};Console.feed.users.body=function(c,e,a){if(SimpleChat.serverId()!=e||!Console.home.prepare(FEED_NAME_USERS,a)||c===false){return}var b=$("#users-online-now");var d=$("#users-online-peak");b.text(c.count);d.text(c.peak.count);d.append(" "+DateTime.template(c.peak.date,true))};Modal.create.name=function(c){var a=$("#modal-header h3");a.text(Utils.tr("console_server_name"));a.attr("data-tr","console_server_name");$("#modal-body").append('<form id="title-form"><div id="name-group" class="control-group"><input id="name-edit" type="text" maxlength="20"><button id="name-ok" type="submit" class="btn" data-tr="ok">'+Utils.tr("ok")+"</button></div></form>");var b=SimpleChat.channel(SimpleChat.serverId());if(b!==null){$("#name-edit").val(b.Name)}};Modal.shown.name=function(){$("#name-edit").focus()};if(typeof SimpleChat!=="undefined"){SimpleChat.online.connect(Console.home.online)};