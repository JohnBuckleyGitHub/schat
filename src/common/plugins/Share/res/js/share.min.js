!function(){"use strict";function a(a){this.cont=b("div",{id:a,"class":"cont image-type panel panel-default"});var c=this.cont.appendChild(b("div",{"class":"panel-heading"}));this.head=c.appendChild(b("span",{"data-tr":"share-upload-images"})),this.cancelBtn=c.appendChild(b("button",{type:"button","class":"btn btn-default btn-cancel btn-xs pull-right","data-tr":"cancel"}));var d=this.cont.appendChild(b("div",{"class":"panel-body"}));this.progress=d.appendChild(b("div",{"class":"progress"})).appendChild(b("div",{"class":"progress-bar"}))}var b=window.schat.ui.createElement;a.prototype.setProgress=function(a,b){this.progress.style.width=Math.floor(100*a/b)+"%",a==b&&this.tr(this.head,"share-please-wait")},a.prototype.setStatus=function(a){var b=200===a?"success":"danger";this.cont.setAttribute("class","cont image-type panel panel-"+b),this.cancelBtn.setAttribute("class","btn btn-cancel btn-xs pull-right btn-"+b),this.progress.setAttribute("class","progress-bar progress-bar-"+b),200!==a?(this.tr(this.cancelBtn,"share-close"),this.tr(this.head,"share-upload-error")):this.cancelBtn.style.display="none"},a.prototype.tr=function(a,b){a.setAttribute("data-tr",b),a.innerHTML=tr(b)},window.schat.ui.ImageUpload=a}(),function(){"use strict";function a(a){this.cont=b("div",{id:a.OID,"class":"cont image-type panel panel-default"});var c=this.cont.appendChild(b("div",{"class":"panel-heading"}));c.innerHTML=DateTime.template(a.Date,a.Day)+Messages.nameBlock(a.Author);var d=this.cont.appendChild(b("div",{"class":"panel-body"})),e=a.JSON;if(1===e.format&&schat.utils.isArray(e.images))for(var f=e.images,g=0;g<f.length;g++)d.appendChild(b("img",{"class":"img-thumbnail",src:e.link+"/S/"+f[g].id.substr(0,2)+"/"+f[g].id+"."+f[g].type}))}var b=window.schat.ui.createElement;schat.ui.ImageMessage=a}(),function(){"use strict";function a(a,b){if(Settings.getId()===a){var c=new schat.ui.ImageUpload(b);Messages.addRawMessage(c.cont),d[b]=c,c.cancelBtn.addEventListener("click",function(){Share.cancel(b),c.cont.parentNode.removeChild(c.cont),delete d[b],alignChat()}),Messages.added.length=0,alignChat()}}function b(a,b,c,e){Settings.getId()===a&&d.hasOwnProperty(b)&&d[b].setProgress(c,e)}function c(a,b,c){Settings.getId()===a&&d.hasOwnProperty(b)&&d[b].setStatus(c)}var d={};Messages.addImageMessage=function(a){console.log(a);var b=a.OID;d.hasOwnProperty(b)&&(d[b].cont.parentNode.removeChild(d[b].cont),delete d[b]);var c=new schat.ui.ImageMessage(a);console.log(c),Messages.addHintedRawMessage(c.cont,a.Hint),ChatView.setLastMessage(a.Date)},"undefined"!=typeof Share?(Share.uploadStarted.connect(a),Share.uploadProgress.connect(b),Share.uploadStatus.connect(c)):window.Share={}}();