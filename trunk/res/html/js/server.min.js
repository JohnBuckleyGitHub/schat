var Hosts={body:function(a){Hosts.read(a)},feed:function(a){if(Pages.current!=1){return}if(!a.hasOwnProperty("type")){return}if(a.own!==true){return}if(a.name!=="hosts"){return}try{Hosts[a.type](a.data)}catch(b){}},processSingleHost:function(d,c){var f="#"+d;if(!$(f).length){var b='<tr class="host-row" id="'+d+'"><td class="os-cell"><i class="icon-status-offline host-status"></i><a class="host-os" rel="tooltip"><i class="icon-os"></i></a></td><td class="host-name"></td><td><a class="host-info" rel="tooltip"><i class="icon-info"></i></a> <span class="last-activity"></span></td><td><a onclick="" class="btn btn-small btn-unlink" data-tr="unlink">Unlink</a></td></tr>';$("#account-table > tbody").append(b)}else{$(f).show()}$(f+" > .host-name").text(c.name);$(f+" .icon-os").attr("class","icon-os os-"+Pages.os(c.os));$(f+" .host-os").attr("data-original-title",htmlspecialchars(c.osName));$(f+" .host-info").attr("data-original-title",Utils.table({version:c.version,last_ip:c.host}));$(f+" .host-status").attr("class",(c.online===true?"icon-status":"icon-status-offline")+" host-status");$(f+" .last-activity").html(DateTime.template(c.date,true));var a=$(f+" .btn-unlink");a.attr("data-id",d);a.off("click");a.on("click",Hosts.unlink)},read:function(b){if(!b.hasOwnProperty("head")){return}$(".host-row").hide();for(var a in b){if(b.hasOwnProperty(a)&&a.length==34){Hosts.processSingleHost(a,b[a])}}$("#hosts-content p").show();$("#hosts-content #fieldset").show();$(".host-row:hidden").remove();$("a[rel=tooltip]").tooltip();$("#main-spinner").hide();Utils.retranslate()},reload:function(){if(Pages.current!=1){return}$("#info-content > h1").html(Messages.nameTemplate(JSON.parse(SimpleChat.channel(Settings.id))));$("#main-spinner").css("display","inline-block");Utils.TR("my_computers");Hosts.read(SimpleChat.feed("hosts",1))},unlink:function(){var a={};a.action="unlink";a.id=$(this).attr("data-id");SimpleChat.request("query","hosts",a);return false},progress:false};Pages.onInfo.push(Hosts.reload);try{ChatView.feed.connect(Hosts.feed);ChatView.reload.connect(Hosts.reload)}catch(e){}var AuthDialog={show:function(){Modal.current="auth";Modal.create.auth(null);$("#modal").modal()},providers:function(){var b=Auth.providers();if(!b.hasOwnProperty("order")){return}for(var a=0;a<b.order.length;a++){var c=b.order[a];if(b.providers.hasOwnProperty(c)){AuthDialog.addProvider(c,b.providers[c])}}$("#modal-header h3 .icon-spinner").remove();Utils.adjustWidth($("#providers .btn"))},addProvider:function(a,b){$("#providers").append('<a class="btn" href="'+b.url+' "><i class="provider-'+a+'"></i> '+b.htmlName+"</a>")},hide:function(){$("#modal").modal("hide")}};Modal.create.auth=function(a){$("#modal-header h3 *").remove();$("#modal-body *").remove();$("#modal-header h3").append("<span></span>");$("#modal-header h3").append(' <i class="icon-spinner"></i>');$("#modal-header h3 span").text(Utils.tr("sign_in_with"));$("#modal-header h3 span").attr("data-tr","sign_in_with");$("#modal-body").append('<div id="providers"></div>');if(Auth.anonymous()){$("#modal-body").append('<div id="anonymous-auth"><a data-tr="or_anon_connect" href="#">'+Utils.tr("or_anon_connect")+"</a></div>");$("#anonymous-auth a").on("click",function(b){b.preventDefault();Auth.open()})}AuthDialog.providers()};Modal.shown.auth=function(){Utils.adjustWidth($("#providers .btn"))};Modal.hidden.auth=function(){Auth.cancel()};if(typeof Auth==="undefined"){Auth={providers:function(){return{}},cancel:function(){},anonymous:function(){return true},open:function(){}}}else{Auth.providersReady.connect(AuthDialog.providers)};