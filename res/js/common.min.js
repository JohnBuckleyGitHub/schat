function alignChat(){if(Settings.scroll){var a=window.innerHeight;if(a>0){var b=window.Chat,c=b.offsetHeight;a-c>0?(b.style.position="relative",b.style.top=a-c-4+"px"):b.style.position="static"}Settings.autoscroll&&(document.body.scrollTop=document.body.offsetHeight)}}function showSeconds(a){a?$("#body").removeClass("no-seconds"):$("#body").addClass("no-seconds")}function showService(a){a?$("#body").removeClass("no-service"):$("#body").addClass("no-service"),alignChat()}+function(a){"use strict";function b(){a(d).remove(),a(e).each(function(b){var d=c(a(this));d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown")),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown"))})}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var d=".dropdown-backdrop",e="[data-toggle=dropdown]",f=function(b){a(b).on("click.bs.dropdown",this.toggle)};f.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){if("ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b),f.trigger(d=a.Event("show.bs.dropdown")),d.isDefaultPrevented())return;f.toggleClass("open").trigger("shown.bs.dropdown"),e.focus()}return!1}},f.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var f=c(d),g=f.hasClass("open");if(!g||g&&27==b.keyCode)return 27==b.which&&f.find(e).focus(),d.click();var h=a("[role=menu] li:not(.divider):visible a",f);if(h.length){var i=h.index(h.filter(":focus"));38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<h.length-1&&i++,~i||(i=0),h.eq(i).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("dropdown");d||c.data("dropdown",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=f,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",e,f.prototype.toggle).on("keydown.bs.dropdown.data-api",e+", [role=menu]",f.prototype.keydown)}(window.jQuery),+function(a){"use strict";var b=function(b,c){this.options=c,this.$element=a(b),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("show.bs.modal",".modal",function(){a(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){a(document.body).removeClass("modal-open")})}(window.jQuery),+function(a){"use strict";var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focus",i="hover"==g?"mouseleave":"blur";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(b),b.isDefaultPrevented())return;var c=this.tip();this.setContent(),this.options.animation&&c.addClass("fade");var d="function"==typeof this.options.placement?this.options.placement.call(this,c[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||"top"),c.detach().css({top:0,left:0,display:"block"}).addClass(d),this.options.container?c.appendTo(this.options.container):c.insertAfter(this.$element);var g=this.getPosition(),h=c[0].offsetWidth,i=c[0].offsetHeight;if(f){var j=this.$element.parent(),k=d,l=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:j.outerWidth(),n="body"==this.options.container?window.innerHeight:j.outerHeight(),o="body"==this.options.container?0:j.offset().left;d="bottom"==d&&g.top+g.height+i-l>n?"top":"top"==d&&g.top-l-i<0?"bottom":"right"==d&&g.right+h>m?"left":"left"==d&&g.left-h<o?"right":d,c.removeClass(k).addClass(d)}var p=this.getCalculatedOffset(d,g,h,i);this.applyPlacement(p,d),this.$element.trigger("shown.bs."+this.type)}},b.prototype.applyPlacement=function(a,b){var c,d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),a.top=a.top+g,a.left=a.left+h,d.offset(a).addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;if("top"==b&&j!=f&&(c=!0,a.top=a.top+f-j),/bottom|top/.test(b)){var k=0;a.left<0&&(k=-2*a.left,a.left=0,d.offset(a),i=d[0].offsetWidth,j=d[0].offsetHeight),this.replaceArrow(k-e+i,i,"left")}else this.replaceArrow(j-f,j,"top");c&&d.offset(a)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach()}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:(d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one(a.support.transition.end,b).emulateTransitionEnd(150):b(),this.$element.trigger("hidden.bs."+this.type),this)},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(window.jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(){var b=c(this),g=f.settings;return isNaN(b.datetime)||(0===g.cutoff||e(b.datetime)<g.cutoff)&&a(this).html(d(b.datetime)),this}function c(b){if(b=a(b),!b.data("timeago")){b.data("timeago",{datetime:f.datetime(b)});var c=a.trim(b.text());f.settings.localeTitle?b.attr("title",b.data("timeago").datetime.toLocaleString()):!(c.length>0)||f.isTime(b)&&b.attr("title")||b.attr("title",c)}return b.data("timeago")}function d(a){return f.inWords(e(a))}function e(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){return b instanceof Date?d(b):"string"==typeof b?d(a.timeago.parse(b)):"number"==typeof b?d(new Date(b)):d(a.timeago.datetime(b))};var f=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(b){function c(c,e){var f=a.isFunction(c)?c(e,b):c,g=d.numbers&&d.numbers[e]||e;return f.replace(/%d/i,g)}var d=tr("timeago"),e=d.prefixAgo,f=d.suffixAgo;this.settings.allowFuture&&0>b&&(e=d.prefixFromNow,f=d.suffixFromNow);var g=Math.abs(b)/1e3,h=g/60,i=h/60,j=i/24,k=j/365,l=45>g&&c(d.seconds,Math.round(g))||90>g&&c(d.minute,1)||45>h&&c(d.minutes,Math.round(h))||90>h&&c(d.hour,1)||24>i&&c(d.hours,Math.round(i))||42>i&&c(d.day,1)||30>j&&c(d.days,Math.round(j))||45>j&&c(d.month,1)||365>j&&c(d.months,Math.round(j/30))||1.5>k&&c(d.year,1)||c(d.years,Math.round(k)),m=d.wordSeparator||"";return void 0===d.wordSeparator&&(m=" "),a.trim([e,l,f].join(m))},datetime:function(b){return new Date(parseInt(a(b).attr("data-date"),10))},isTime:function(b){return"time"===a(b).get(0).tagName.toLowerCase()}});var g={init:function(){var c=a.proxy(b,this);c();var d=f.settings;d.refreshMillis>0&&(this._timeagoInterval=setInterval(c,d.refreshMillis))},update:function(c){a(this).data("timeago",{datetime:f.parse(c)}),b.apply(this)},updateFromDOM:function(){a(this).data("timeago",{datetime:f.parse(f.isTime(this)?a(this).attr("datetime"):a(this).attr("title"))}),b.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};a.fn.timeago=function(a,b){var c=a?g[a]:g.init;if(!c)throw new Error("Unknown function name '"+a+"' for timeago");return this.each(function(){c.call(this,b)}),this}}),function(){"use strict";window.schat={net:{},ui:{},utils:{},lang:{},page:""}}(),function(){"use strict";var a=window.schat.utils;a.isFunction=function(a){return"function"==typeof a},a.isArray=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)},a.randomId=function(){var a=new Array(16);return uuid.v4(null,a,0),base32.encode(a)},a.format=function(a,b){return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}}(),function(){"use strict";function a(a,b,c,d){var e=0,f=0,g=!1;("undefined"==typeof b||null===b)&&(b=2),a=a.toString(),d!==!1&&(a=a.replace(/&/g,"&amp;")),a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");var h={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===b&&(g=!0),"number"!=typeof b){for(b=[].concat(b),f=0;f<b.length;f++)0===h[b[f]]?g=!0:h[b[f]]&&(e|=h[b[f]]);b=e}return b&h.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/'/g,"&#039;")),g||(a=a.replace(/"/g,"&quot;")),a}schat.utils.encode=a}(),function(){"use strict";function a(a,b,c,d){var e=a%10;return 1==e&&(1==a||a>20)?b:e>1&&5>e&&(a>20||10>a)?c:d}function b(a,b){if("timeago"===a){var c=SimpleChat.translate("lang");return e[e.hasOwnProperty(c)?c:"en"]}return SimpleChat.translate(a,b)}function c(a){$('[data-tr="'+a+'"]').html(b(a))}function d(){$("[data-tr]").each(function(){c($(this).attr("data-tr"))})}var e={en:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"<b>%d</b> minutes",hour:"about an hour",hours:"about <b>%d</b> hours",day:"a day",days:"<b>%d</b> days",month:"about a month",months:"<b>%d</b> months",year:"about a year",years:"<b>%d</b> years",wordSeparator:" ",numbers:[]},ru:{prefixAgo:null,prefixFromNow:"через",suffixAgo:"назад",suffixFromNow:null,seconds:"меньше минуты",minute:"минуту",minutes:function(b){return a(b,"<b>%d<b/> минуту","<b>%d</b> минуты","<b>%d</b> минут")},hour:"час",hours:function(b){return a(b,"<b>%d</b> час","<b>%d</b> часа","<b>%d</b> часов")},day:"день",days:function(b){return a(b,"<b>%d</b> день","<b>%d</b> дня","<b>%d</b> дней")},month:"месяц",months:function(b){return a(b,"<b>%d</b> месяц","<b>%d</b> месяца","<b>%d</b> месяцев")},year:"год",years:function(b){return a(b,"<b>%d</b> год","<b>%d</b> года","<b>%d</b> лет")}}};"undefined"!=typeof SimpleChat&&SimpleChat.retranslated.connect(function(){d()}),window.tr=b,window.TR=c,schat.lang.retranslate=d,window.Utils=window.Utils||{},window.Utils.tr=b,window.Utils.TR=c,window.Utils.retranslate=d}(),function(){"use strict";window.schat.ui.main=document.getElementById("main"),window.schat.ui.createElement=function(a,b,c){var d=document.createElement(a);for(var e in b)b.hasOwnProperty(e)&&d.setAttribute(e,b[e]);return"string"==typeof c?d.innerHTML=c:"object"==typeof c&&c.hasOwnProperty("text")&&(d.textContent=c.text),b&&b.hasOwnProperty("data-tr")&&(d.innerHTML=tr(b["data-tr"])),d}}(),function(){"use strict";var a=window.schat.ui.createElement,b=document.getElementById("modal"),c=a("div",{"class":"modal-dialog"}),d=c.appendChild(a("div",{"class":"modal-content"})),e=d.appendChild(a("div",{"class":"modal-header"}));e.appendChild(a("button",{"class":"close","data-dismiss":"modal","aria-hidden":"true"},"&times;"));var f=e.appendChild(a("h4",{"class":"modal-title"})),g=d.appendChild(a("div",{"class":"modal-body"})),h=d.appendChild(a("div",{"class":"modal-footer"}));b.appendChild(c),schat.ui.modal={element:b,header:e,title:f,body:g,footer:h,current:null,dialog:c},$(document).ready(function(){$(b).on("hidden.bs.modal",function(){if(schat.ui.modal.current)try{schat.ui.modal.current.hidden()}catch(a){}f.textContent="",g.textContent="",h.textContent="",h.style.display="block",schat.ui.modal.current=null})}),$(b).on("shown.bs.modal",function(){if(schat.ui.modal.current)try{schat.ui.modal.current.shown()}catch(a){}})}();var FEED_METHOD_GET="get",FEED_METHOD_PUT="put",FEED_METHOD_POST="post",FEED_METHOD_DELETE="delete",FEED_NAME_ACL="acl",FEED_NAME_CONSOLE="console",FEED_NAME_HOSTS="hosts",FEED_NAME_INFO="info",FEED_NAME_LIST="list",FEED_NAME_MESSAGES="messages",FEED_NAME_PROFILE="profile",FEED_NAME_SERVER="server",FEED_NAME_USER="user",FEED_NAME_USERS="users",SERVER_FEED_AUTH_KEY="auth",SERVER_FEED_AUTH_REQ="server/auth",SERVER_FEED_POLICY_KEY="policy",SERVER_FEED_POLICY_REQ="server/policy",SERVER_FEED_OAUTH_KEY="oauth",SERVER_FEED_OAUTH_REQ="server/oauth",CONSOLE_FEED_ME_KEY="me",CONSOLE_FEED_ME_REQ="console/me",INFO_FEED_LOGGING_KEY="logging",INFO_FEED_LOGGING_REQ="info/logging",INFO_FEED_PINNED_KEY="pinned",INFO_FEED_PINNED_REQ="info/pinned",INFO_FEED_SUDO_REQ="info/sudo",INFO_FEED_TITLE_REQ="info/title",INFO_FEED_VISIBILITY_REQ="info/visibility",ACL_FEED_HEAD_OTHER_REQ="acl/head/other",ACL_FEED_HEAD_OWNER_REQ="acl/head/owner",ACL_FEED_HEAD_MASK_REQ="acl/head/mask",LIST_FEED_ID_REQ="list/id",Settings={id:"",status:"",scroll:!1,scrollTo:null,autoscroll:"undefined"!=typeof SimpleChat?SimpleChat.value("AutoScroll"):!0,getId:function(){return""==Settings.id&&(Settings.id=ChatView.getId()),Settings.id},changed:function(a,b){"AutoScroll"==a&&(Settings.autoscroll=b,b===!0&&alignChat())}};window.Utils=window.Utils||{},Utils.left=function(a,b){return"string"!=typeof a?"":a.length<b?a:a.slice(0,b)},Utils.simplified=function(a){return $.trim(a.replace(/\s+/gi," "))},Utils.table=function(a){var b="<table><tbody>";for(var c in a)a.hasOwnProperty(c)&&(b+="<tr><td>"+Utils.tr(c)+"</td><td>"+a[c]+"</td></tr>");return b+="</table></tbody>"},Utils.row=function(a,b){return"string"!=typeof b||""===b?"":'<div class="field-row field-'+a+'">'+'<span class="field-row-label"><span data-tr="'+a+'">'+tr(a)+"</span>:</span> "+'<span class="field-row-value">'+b+"</span>"+"</div>"},Utils.adjustWidth=function(a){if(a.length&&!(a.width()<1)&&a.is(":visible")){a.css("width","");var b=0,c=0;a.each(function(){c=$(this).width(),c>b&&(b=c)}),a.width(b+4)}};var Pages={current:0,onInfo:[],onMessages:[],os:function(a){return 0==a||a>79?"unknown":a>=1&&20>a?"windows":a>=20&&40>a?"osx":41==a?"ubuntu":42==a?"gentoo":43==a?"debian":44==a?"opensuse":45==a?"fedora":79==a?"android":a>=40?"linux":"unknown"},setPage:function(a){if(SimpleChat.setTabPage(Settings.id,a),Pages.current=a,0==a){$("#page-switcher-start").hide(),$("#page-switcher-end").show(),$("#messages").addClass("active"),$("#info").removeClass("active"),alignChat();for(var b=0;b<Pages.onMessages.length;b++)Pages.onMessages[b]()}else if(1==a)for($("#page-switcher-start").show(),$("#page-switcher-end").hide(),$("#messages").removeClass("active"),$("#info").addClass("active"),b=0;b<Pages.onInfo.length;b++)Pages.onInfo[b]()}};Pages.onInfo.push(function(){var a=SimpleChat.channel(Settings.getId());null!==a&&$("#channel-name").html(Messages.nameTemplate(a))});var Messages={onAdd:[],onBulkAdd:[],unhandled:[],added:[],add:function(a){Messages.added.push(a)},feed:function(a){if(200==a.status&&a.feed==FEED_NAME_MESSAGES&&a.cmd==FEED_METHOD_DELETE){var b=a.name.split("/",2);if(2==b.length){var c=document.getElementById(b[1]),d=c.getAttribute("data-remover")||"generic";if(null!==c)try{Messages[d+"Remover"](c)}catch(e){console.error(e)}}}},genericRemover:function(a){var b=a.firstChild;b.classList.add("removed"),b.children[2].innerHTML='<span class="message-removed" data-tr="message-removed">'+Utils.tr("message-removed")+'</span> <i class="message-trash"></i>'},setMessageId:function(a,b){b.hasOwnProperty("OID")?(a.id=b.OID,a.setAttribute("data-mdate",b.MDate)):a.id=b.Id},addChannelMessage:function(a){var b=null;if(a.hasOwnProperty("InternalId")&&(b=document.getElementById(a.InternalId),null!==b))return Messages.updateChannelMessage(b,a),void 0;if(b=a.hasOwnProperty("OID")?document.getElementById(a.OID):document.getElementById(a.Id),null!==b)return Messages.updateChannelMessage(b,a),void 0;var c=document.createElement("div");Messages.setMessageId(c,a),c.setAttribute("class","cont "+a.Type+"-type"),c.setAttribute("data-time",a.Date);var d='<div class="blocks ';d+=a.Direction,void 0!==a.Status&&(d+=" "+a.Status),"me"==a.Command&&(d+=" me-action"),d+='">',d+=DateTime.template(a.Date,a.Day),d+=Messages.nameBlock(a.Author),d+='<span class="msg-body-block">'+a.Text+"</span>",d+="</div>",c.innerHTML=d,Messages.addHintedRawMessage(c,a.Hint),a.hasOwnProperty("Status")&&"undelivered"==a.Status||ChatView.setLastMessage(a.Date)},addHintedRawMessage:function(a,b){if("before"==b.Hint){var c=document.getElementById(b.Id);if(null!==c)return c.parentNode.insertBefore(a,c),Messages.add(a.id),void 0}Messages.addRawMessage(a,b.Day)},addMessage:function(a){var b=a.Func;if(void 0!=b&&Messages.hasOwnProperty(b))try{"unhandled"!==a.Type&&Messages.day(a.Hint.Day),Messages[b](a)}catch(c){console.error(c)}},addMessages:function(a){if(a.length){var b=Messages,c=Settings.scroll,d=Settings.scrollTo;Settings.scroll=!1,Settings.scrollTo=null;for(var e=0;e<a.length;e++)b.addMessage(a[e]);for(e=0;e<b.added.length;e++)for(var f=0;f<b.onAdd.length;f++)b.onAdd[f](b.added[e]);for(e=0;e<b.onBulkAdd.length;e++)b.onBulkAdd[e](b.added);Settings.scroll=c,b.added.length?b.added.length=0:null===Settings.scrollTo&&(Settings.scrollTo=d),alignChat(),null!==Settings.scrollTo&&document.getElementById(Settings.scrollTo).scrollIntoView()}},addRawMessage:function(a){window.Chat.appendChild(a),Messages.add(a.id)},addServiceMessage:function(a){var b=document.createElement("div");b.id=a.Id,b.setAttribute("class","cont "+a.Type+"-type"),b.innerHTML='<div class="blocks '+(void 0!==a.Extra?a.Extra:"")+'">'+DateTime.template(a.Date,!1)+Messages.nameBlock(a.Author)+'<span class="msg-body-block">'+a.Text+"</span>"+"</div>",Messages.addRawMessage(b,a.Hint.Day)},addAlertMessage:function(a){var b=document.createElement("div");b.id=a.Id,b.setAttribute("class","cont "+a.Type+"-type"),b.innerHTML='<div class="blocks '+(void 0!==a.Extra?a.Extra:"")+'">'+'<div class="alert-box">'+'<div class="alert-box-icon"></div>'+'<div class="alert-box-body">'+a.Text+"</div>"+'<div class="alert-box-buttons">'+'<a class="alert-box-close" href="#" data-id="'+a.Id+'"></a>'+"</div>"+"</div>"+"</div>",Messages.addRawMessage(b,a.Hint.Day)},addUnhandledMessage:function(a){for(var b=0;b<Messages.unhandled.length;b++)Messages.unhandled[b](a)},nameBlock:function(a){var b=Messages.nameTemplate(a);return""==b?b:'<span class="nick-block">'+b+"</span> "},nameTemplate:function(a){return void 0===a?"":'<a class="nick '+a.Id+" color-"+a.Color+'" href="'+a.Url+'">'+schat.utils.encode(a.Name)+"</a>"},reload:function(){0==Pages.current&&($(".cont").remove(),alignChat())},updateChannelMessage:function(a,b){Messages.setMessageId(a,b);var c=b.Direction;void 0!==b.Status&&(c+=" "+b.Status),"me"==b.Command&&(c+=" me-action");var d=a.firstChild;if(d.setAttribute("class","blocks "+c),b.Date>0&&a.getAttribute("data-time")!=b.Date){var e=new Date(b.Date);d.firstChild.innerHTML='<span class="time">'+DateTime.time(e)+'</span><span class="seconds">'+DateTime.seconds(e)+"</span> ",a.setAttribute("data-time",b.Date),ChatView.setLastMessage(b.Date)}},day:function(){},rename:function(a){var b=$("a."+a.Id);b.attr("href",a.Url),b.html(schat.utils.encode(a.Name))},recolor:function(a){var b=$("a."+a.Id);b.removeClassRegEx(/^color-/),b.addClass("color-"+a.Color)}},DateTime={day:function(a){return DateTime.pad(a.getDate())+"."+DateTime.pad(a.getMonth()+1)+"."+a.getFullYear()},dayId:function(a){return a.getFullYear()+"_"+DateTime.pad(a.getMonth()+1)+"_"+DateTime.pad(a.getDate())},pad:function(a){return 10>a?"0"+a:a},seconds:function(a){return":"+DateTime.pad(a.getSeconds())},template:function(a,b){if(a>0){var c=new Date(a),d='<span class="date-time-block">';return b===!0&&(d+='<span class="day">'+DateTime.day(c)+"</span> "),d+='<span class="time">'+DateTime.time(c)+"</span>"+'<span class="seconds">'+DateTime.seconds(c)+"</span> </span>"}return""},time:function(a){return DateTime.pad(a.getHours())+":"+DateTime.pad(a.getMinutes())}},Loader={jsfiles:[],done:function(){ChatView.loadFinished(),alignChat()},load:function(a){for(var b=0;b<a.length;b++)Loader.jsfiles.push(a[b]);for(b=0;b<Loader.jsfiles.length;b++)Loader.loadJS(Loader.jsfiles[b])},loadCSS:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet"),b.setAttribute("href",a),document.getElementsByTagName("head")[0].appendChild(b)},loadJS:function(a,b){$.ajax({url:a,dataType:"script",isLocal:!0,success:function(){Loader.remove(a),"function"==typeof b&&b()},error:function(){Loader.remove(a)}})},remove:function(a){var b=Loader.jsfiles.indexOf(a);-1!==b&&(Loader.jsfiles.splice(b,1),0===Loader.jsfiles.length&&Loader.done())},spinner:{tasks:[],current:null,add:function(a){if(null===Loader.spinner.current||Loader.spinner.current!=a){var b=a.split("/")[0];Loader.spinner.current=a,$("#loading-text").html(Utils.tr(b)),$("#loading-text").attr("data-tr",b),$("#loading-body").fadeIn("fast");var c=Loader.spinner.tasks,d=c.indexOf(a);-1!=d&&c.splice(d,1),c.unshift(a)}},remove:function(a){Loader.spinner.current=null;var b=Loader.spinner.tasks,c=b.indexOf(a);-1!=c&&(b.splice(c,1),0==c&&(Loader.spinner.current=null,b.length?Loader.spinner.add(b[0]):$("#loading-body").fadeOut("fast")))},prepare:function(a,b){return 302==b?(Loader.spinner.add("loading/"+a),!0):(Loader.spinner.remove("loading/"+a),200==b||300==b)}}},Modal={current:null,create:{},hidden:{},shown:{},init:function(){var a=$("body");a.on("click.modal",".modal-toggle",function(a){a.preventDefault();var b=$(this).attr("data-handler");if(void 0!==b&&Modal.create.hasOwnProperty(b)){if(Modal.create[b](a)===!1)return;Modal.current=b}$(schat.ui.modal.element).modal()}),a.on("click",'[data-dismiss="alert"]',function(a){a.preventDefault(),$(this).parent().remove(),alignChat()})}};$(document).ready(function(){window.Chat=document.getElementById("Chat"),$(window).resize(alignChat),$("#page-switcher-start").on("click",function(){Pages.setPage(0)}),$("#page-switcher-end").on("click",function(){Pages.setPage(1)});var a=ChatView.jsfiles();return 0===a.length?(Loader.done(),void 0):($("body").on("click",".alert-box-close",function(a){a.preventDefault(),$("#"+$(this).attr("data-id")).remove(),alignChat()}),Modal.init(),Loader.load(a),void 0)}),function(a){a.fn.removeClassRegEx=function(b){var c=a(this).attr("class");if(!c||!b)return!1;var d=[];c=c.split(" ");for(var e=0,f=c.length;f>e;e++)c[e].match(b)||d.push(c[e]);a(this).attr("class",d.join(" "))}}(jQuery),"undefined"==typeof SimpleChat?SimpleChat={bytesToHuman:function(){return"0 bytes"},channel:function(){return"{}"},day:function(a){return a},encryption:function(){return!1},feed:function(){return!1},get:function(){},id:function(){return""},isOnline:function(){return!0},match:function(){return-1},mdate:function(){return 0},randomId:function(){return""},request:function(){},serverId:function(){return""},serverPeer:function(){return""},setTabPage:function(){},status:function(){return"Offline"},statusText:function(){return""},toBase32:function(){return""},traffic:function(){return{tx:0,rx:0}},translate:function(a){return a},value:function(){return null},pinTab:function(){},aclToInt:function(){return 6}}:(SimpleChat.renamed.connect(Messages.rename),SimpleChat.recolored.connect(Messages.recolor),SimpleChat.settingsChanged.connect(Settings.changed)),"undefined"==typeof ChatView?ChatView={jsfiles:function(){return[]},loadFinished:function(){},getId:function(){return""},setLastMessage:function(){},removeDay:function(){},allowFocus:function(){}}:(ChatView.reload.connect(Messages.reload),ChatView.messages.connect(Messages.addMessages),ChatView.feed.connect(Messages.feed));