var Profile={addRow:function(c,b){var a='<tr class="profile-row" id="field-'+c+'"><td class="field-label"><span data-tr="field-'+c+'">'+Utils.tr("field-"+c)+'</span>:</td><td class="field-value">'+b+"</td></tr>";$("#profile-table > tbody").append(a)},body:function(a){Profile.read(a)},feed:function(a){if(Pages.current!=1){return}if(!a.hasOwnProperty("type")){return}if(a.name!=="profile"){return}try{Profile[a.type](a.data)}catch(b){}},read:function(c){if(!c.hasOwnProperty("head")){return}$(".profile-row").remove();var a=SimpleChat.fields();for(var b=0;b<a.length;b++){var g=a[b];if(!c.hasOwnProperty(g)){continue}var d=c[g];if(typeof d==="string"&&d===""){continue}try{Profile.Field[g](g,d)}catch(f){}}$("#main-spinner").hide()},reload:function(){if(Pages.current!=1){return}$("#main-spinner").css("display","inline-block");Utils.TR("profile");Profile.read(SimpleChat.feed(Settings.id,"profile"))},reply:function(a){if(a.action!=="x-set"){return}Profile.read(SimpleChat.feed(Settings.id,"profile"))},Field:{name:function(a,b){Profile.addRow(a,Utils.left(htmlspecialchars(Utils.simplified(b)),128))}}};var Connections={body:function(a){Connections.read(a)},feed:function(a){if(Pages.current!=1){return}if(!a.hasOwnProperty("type")){return}if(a.name!=="user"){return}try{Connections[a.type](a.data)}catch(b){}},process:function(b,a){var c="#"+b;$("#connections").append('<div class="connection-row bottom-line" id="'+b+'"><i class="icon-os"></i> <span class="connection-host"></span></div>');$(c+" .icon-os").attr("class","icon-os os-"+Pages.os(a.os));$(c+" .icon-os").attr("data-original-title",htmlspecialchars(a.osName));$(c+" > .connection-host").text(a.host)},read:function(c){if(!c.hasOwnProperty("head")&&!c.hasOwnProperty("connections")){return}$(".connection-row").remove();var b=c.connections;var d=0;for(var a in b){if(b.hasOwnProperty(a)&&a.length==34){d++;Connections.process(a,b[a])}}$("#connections-spinner").hide();if(d>0){$("#user-offline").hide();$(".icon-os").tooltip()}else{$("#user-offline").show()}},reload:function(){if(Pages.current!=1){return}$("#connections-spinner").css("display","inline-block");Utils.TR("connections");Utils.TR("user_offline");Connections.read(SimpleChat.feed(Settings.id,"user"));Utils.retranslate()}};Pages.onInfo.push(Profile.reload);Pages.onInfo.push(Connections.reload);try{ChatView.feed.connect(Profile.feed);ChatView.reload.connect(Profile.reload);ChatView.feed.connect(Connections.feed);ChatView.reload.connect(Connections.reload)}catch(e){};