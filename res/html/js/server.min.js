var Hosts={body:function(a){Hosts.read(a)},feed:function(a){if(Pages.current!=1){return}if(!a.hasOwnProperty("type")){return}if(a.own!==true){return}if(a.name!=="hosts"){return}try{Hosts[a.type](a.data)}catch(b){}},processSingleHost:function(d,c){var f="#"+d;if(!$(f).length){var b='<tr class="host-row" id="'+d+'"><td class="os-cell"><i class="icon-status-offline host-status"></i><a class="host-os" rel="tooltip"><i class="icon-os"></i></a></td><td class="host-name"></td><td><a class="host-info" rel="tooltip"><i class="icon-info"></i></a> <span class="last-activity"></span></td><td><a onclick="" class="btn btn-small btn-unlink" data-tr="unlink">Unlink</a></td></tr>';$("#account-table > tbody").append(b)}else{$(f).show()}$(f+" > .host-name").text(c.name);$(f+" .icon-os").attr("class","icon-os os-"+Pages.os(c.os));$(f+" .host-os").attr("data-original-title",htmlspecialchars(c.osName));$(f+" .host-info").attr("data-original-title",Utils.table({version:c.version,last_ip:c.host}));$(f+" .host-status").attr("class",(c.online===true?"icon-status":"icon-status-offline")+" host-status");var a=$(f+" .btn-unlink");a.attr("data-id",d);a.off("click");a.on("click",Hosts.unlink)},read:function(b){if(!b.hasOwnProperty("head")){return}$(".host-row").hide();for(var a in b){if(b.hasOwnProperty(a)&&a.length==34){Hosts.processSingleHost(a,b[a])}}$("#hosts-content p").show();$("#hosts-content #fieldset").show();$(".host-row:hidden").remove();$("a[rel=tooltip]").tooltip();if(!Hosts.progress){Hosts.progress=true;SimpleChat.request("query","hosts",{action:"activity"})}Utils.retranslate()},readActivity:function(b,a){$("#"+b+" .last-activity").html(DateTime.template(a.date,true))},reload:function(){if(Pages.current!=1){return}$("#info-content > h1").html(Messages.nameTemplate(JSON.parse(SimpleChat.channel(Settings.id))));$("#main-spinner").css("display","inline-block");Utils.TR("my_computers");Hosts.read(SimpleChat.feed("hosts",false))},reply:function(b){if(b.action!=="activity"){return}Hosts.progress=false;for(var a in b){if(b.hasOwnProperty(a)&&a.length==34){Hosts.readActivity(a,b[a])}}$("#main-spinner").hide()},unlink:function(){var a={};a.action="unlink";a.id=$(this).attr("data-id");SimpleChat.request("query","hosts",a);return false},progress:false};Pages.onInfo.push(Hosts.reload);try{ChatView.feed.connect(Hosts.feed);ChatView.reload.connect(Hosts.reload)}catch(e){};