$.extend(jQuery,{JSONView:function(n,b){var g;if(typeof n=="string"){g=JSON.parse(n)}else{g=n}var d,h=[],k=b;var e=function(c,f){return new Array(f+1).join(c)};var a=function(t,r,f){for(var u in t){var q=t[u];switch(typeof q){case"function":break;case"string":if(r){h.push({Text:'<span class="jsonstring">"'+htmlspecialchars(q)+'"</span><span class="jsontag">,</span>',Step:f})}else{h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">: </span><span class="jsonstring">"'+htmlspecialchars(q)+'"</span><span class="jsontag">,</span>',Step:f})}break;case"boolean":if(r){h.push({Text:'<span class="jsonboolean">"'+q+'"</span><span class="jsontag">,</span>',Step:f})}else{h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">: </span><span class="jsonboolean">'+q+'</span><span class="jsontag">,</span>',Step:f})}break;case"number":if(r){h.push({Text:'<span class="jsonnumber">'+q+'</span><span class="jsontag">,</span>',Step:f})}else{h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">: </span><span class="jsonnumber">'+q+'</span><span class="jsontag">,</span>',Step:f})}break;case"object":if(q===null){if(r){h.push({Text:'<span class="jsonnull">'+q+'</span><span class="jsontag">,</span>',Step:f})}else{h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">: </span><span class="jsonnull">'+q+'</span><span class="jsontag">,</span>',Step:f})}}else{if(q.length==undefined){if(!r){h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">:</span>',Step:f})}h.push({Text:'<span class="jsontag">{</span>',Step:f});a(q,false,f+1);h.push({Text:'<span class="jsontag">},</span>',Step:f})}else{if(!r){h.push({Text:'<span class="jsonname">"'+htmlspecialchars(u)+'"</span><span class="jsontag">:</span>',Step:f})}h.push({Text:'<span class="jsontag">[</span>',Step:f});a(q,true,f+1);h.push({Text:'<span class="jsontag">],</span>',Step:f})}}break;default:break}}var l=h.pop();var c=",</span>";if(l.Text.substr(l.Text.length-c.length)==c){h.push({Text:l.Text.replace(c,"</span>"),Step:l.Step})}else{h.push(l)}};if(g.length==undefined){h.push({Text:'<span class="jsontag">{</span>',Step:0});a(g,false,1);h.push({Text:'<span class="jsontag">}</span>',Step:0})}else{h.push({Text:'<span class="jsontag">[</span>',Step:0});a(g,true,1);h.push({Text:'<span class="jsontag">]</span>',Step:0})}var j=true;k.addClass("KelpJSONView");k.append("<ol></ol>");k=k.find("ol");for(var i in h){var m=h[i];if(j){k.append($('<li class="jsonhighlight">'+e("&nbsp; ",m.Step)+m.Text+"</li>"));j=false}else{k.append($("<li>"+e("&nbsp; ",m.Step)+m.Text+"</li>"));j=true}}}});